"use strict";(self.webpackChunknifty_bees_calculator=self.webpackChunknifty_bees_calculator||[]).push([[390],{3390:(O,g,c)=>{c.r(g),c.d(g,{DipInvestmentComponent:()=>S});var u=c(6895),r=c(433),v=c(9199),p=c(1135),h=c(7579),b=c(5243),f=c(4671),Z=c(4482),y=c(5403);function T(n,a){return n===a}var d=c(2722),t=c(8256),x=c(114);function A(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",44)(1,"div",39)(2,"div",45)(3,"label",46),t._uU(4,"Fall %"),t.qZA(),t.TgZ(5,"div",47),t._UZ(6,"input",48),t.TgZ(7,"span",28),t._uU(8,"%"),t.qZA()()(),t.TgZ(9,"div",45)(10,"label",46),t._uU(11,"Investment"),t.qZA(),t.TgZ(12,"div",47)(13,"span",28),t._uU(14,"\u20b9"),t.qZA(),t._UZ(15,"input",49),t.qZA()(),t.TgZ(16,"div",50)(17,"button",51),t.NdJ("click",function(){const l=t.CHM(e).index,s=t.oxw();return t.KtG(s.removeDipRule(l))}),t._UZ(18,"i",52),t.qZA()()()()}if(2&n){const e=a.index,i=t.oxw();t.Q6J("formGroupName",e),t.xp6(17),t.Q6J("disabled",i.dipRulesArray.length<=1)}}function C(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",22)(1,"button",53),t.NdJ("click",function(){const l=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.applyPreset(l.key))}),t._uU(2),t._UZ(3,"br"),t.TgZ(4,"small"),t._uU(5),t.qZA()()()}if(2&n){const e=a.$implicit;t.xp6(2),t.hij(" ",e.name,""),t.xp6(3),t.Oqu(e.description)}}function D(n,a){1&n&&(t.TgZ(0,"div",54),t._UZ(1,"div",55),t._uU(2," Calculating dip investment returns... "),t.qZA())}function k(n,a){if(1&n&&(t.TgZ(0,"div",70)(1,"div",71)(2,"div",72),t._uU(3),t.qZA(),t.TgZ(4,"div",73),t._uU(5),t.qZA()()()),2&n){const e=a.$implicit;t.xp6(2),t.Q6J("ngClass",e.colorClass),t.xp6(1),t.Oqu(e.value),t.xp6(2),t.Oqu(e.label)}}function I(n,a){if(1&n&&(t.TgZ(0,"div",74)(1,"div",72),t._uU(2),t.qZA(),t.TgZ(3,"div",73),t._uU(4),t.qZA()()),2&n){const e=a.$implicit;t.xp6(1),t.Q6J("ngClass",e.colorClass),t.xp6(1),t.Oqu(e.value),t.xp6(2),t.Oqu(e.label)}}function U(n,a){if(1&n&&(t.TgZ(0,"div",74)(1,"div",76)(2,"div",72),t._uU(3),t.qZA(),t.TgZ(4,"div",73),t._uU(5),t.qZA()()()),2&n){const e=a.$implicit;t.xp6(2),t.Q6J("ngClass",e.colorClass),t.xp6(1),t.Oqu(e.value),t.xp6(2),t.Oqu(e.label)}}function R(n,a){if(1&n&&(t.TgZ(0,"div",58)(1,"div",17)(2,"h6",59),t._UZ(3,"i",75),t._uU(4," Dip Strategy vs Regular SIP Comparison "),t.qZA(),t.TgZ(5,"div",61),t.YNc(6,U,6,3,"div",62),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(6),t.Q6J("ngForOf",e.comparisonMetricsArray)("ngForTrackBy",e.trackByComparison)}}function q(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"td")(5,"span",77),t._uU(6),t.qZA()(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA()()),2&n){const e=a.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(t.xi3(3,10,e.date,"dd/MM/yyyy")),t.xp6(3),t.ekj("bg-primary","Regular SIP"===e.type)("bg-success",e.type.includes("Dip")),t.xp6(1),t.hij(" ",e.type," "),t.xp6(2),t.hij("\u20b9",i.formatNumber(e.amount),""),t.xp6(2),t.hij("\u20b9",e.price.toFixed(2),""),t.xp6(2),t.Oqu(e.units.toFixed(2)),t.xp6(2),t.Oqu(e.totalUnits.toFixed(2))}}function F(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div",56),t.YNc(2,k,6,3,"div",57),t.qZA(),t.TgZ(3,"div",58)(4,"div",17)(5,"h6",59),t._UZ(6,"i",60),t._uU(7," Dip Investment Statistics "),t.qZA(),t.TgZ(8,"div",61),t.YNc(9,I,5,3,"div",62),t.qZA()()(),t.YNc(10,R,7,2,"div",63),t.ALo(11,"async"),t.TgZ(12,"div",16)(13,"div",17)(14,"h6",59),t._UZ(15,"i",64),t._uU(16," Recent Transactions "),t.TgZ(17,"span",65),t._uU(18),t.qZA()(),t.TgZ(19,"div",66)(20,"table",67)(21,"thead",68)(22,"tr")(23,"th"),t._uU(24,"Date"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Type"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"Amount"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Price"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Units"),t.qZA(),t.TgZ(33,"th"),t._uU(34,"Total Units"),t.qZA()()(),t.TgZ(35,"tbody"),t.YNc(36,q,15,13,"tr",69),t.ALo(37,"async"),t.qZA()()()()(),t.BQk()),2&n){const e=a.ngIf,i=t.oxw();t.xp6(2),t.Q6J("ngForOf",i.keyMetrics)("ngForTrackBy",i.trackByMetric),t.xp6(7),t.Q6J("ngForOf",i.dipStats)("ngForTrackBy",i.trackByStat),t.xp6(1),t.Q6J("ngIf",t.lcZ(11,8,i.comparisonMetrics$)),t.xp6(8),t.hij("",e.transactions.length," total"),t.xp6(18),t.Q6J("ngForOf",t.lcZ(37,10,i.recentTransactions$))("ngForTrackBy",i.trackByTransaction)}}let S=(()=>{class n{constructor(e,i,o){this.fb=e,this.calculatorService=i,this.cdr=o,this._sipResult$=new p.X(null),this.regularSipComparison$=new p.X(null),this._isCalculating$=new p.X(!1),this.dipStatsSubject$=new p.X({count:0,amount:0,percentage:0}),this._recentTransactions$=new p.X([]),this._comparisonMetrics$=new p.X(null),this.destroy$=new h.x,this.dipRulesArray=[],this.keyMetrics=[],this.dipStats=[],this.comparisonMetricsArray=[],this.presetOptions=[{key:"conservative",name:"Conservative",description:"5%, 10% dips"},{key:"moderate",name:"Moderate",description:"5%, 10%, 15%"},{key:"aggressive",name:"Aggressive",description:"Multiple levels"},{key:"opportunistic",name:"Opportunistic",description:"Small dips too"}],this.trackByIndex=l=>l,this.trackByPreset=(l,s)=>s.key,this.trackByMetric=(l,s)=>s.label,this.trackByStat=(l,s)=>s.label,this.trackByComparison=(l,s)=>s.label,this.trackByTransaction=(l,s)=>`${s.date.getTime()}-${s.type}`}ngOnInit(){this.initializeForm(),this.setupFormValidation(),this.subscribeToStateChanges(),this.calculateSIP()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}get dipRules(){return this.dipForm.get("dipRules")}initializeForm(){this.dipForm=this.fb.group({startDate:["2010-01-01",r.kI.required],endDate:["2024-12-17",r.kI.required],baseAmount:[1e4,[r.kI.required,r.kI.min(500)]],lookbackDays:[30,[r.kI.required,r.kI.min(7),r.kI.max(365)]],dipRules:this.fb.array([this.createDipRule(5,5e3),this.createDipRule(10,1e4),this.createDipRule(20,2e4)])}),this.updateDipRulesArray()}createDipRule(e,i){return this.fb.group({percentage:[e,[r.kI.required,r.kI.min(1),r.kI.max(50)]],amount:[i,[r.kI.required,r.kI.min(1e3)]]})}setupFormValidation(){this.dipForm.valueChanges.pipe((0,b.b)(800),function _(n,a=f.y){return n=n??T,(0,Z.e)((e,i)=>{let o,l=!0;e.subscribe((0,y.x)(i,s=>{const m=a(s);(l||!n(o,m))&&(l=!1,o=m,i.next(s))}))})}((e,i)=>JSON.stringify(e)===JSON.stringify(i)),(0,d.R)(this.destroy$)).subscribe(()=>{this.dipForm.valid&&this.calculateSIP()})}subscribeToStateChanges(){this.sipResult$.pipe((0,d.R)(this.destroy$)).subscribe(e=>{e&&(this.updateKeyMetrics(e),this.updateRecentTransactions(e))}),this.regularSipComparison$.pipe((0,d.R)(this.destroy$)).subscribe(e=>{e&&this._sipResult$.value&&this.updateComparisonMetrics(this._sipResult$.value,e)}),this.dipStatsSubject$.pipe((0,d.R)(this.destroy$)).subscribe(e=>{this.updateDipStatsArray(e)})}updateKeyMetrics(e){this.keyMetrics=[{label:"Total Invested",value:this.formatCurrency(e.totalInvested),colorClass:"text-primary"},{label:"Current Value",value:this.formatCurrency(e.currentValue),colorClass:"text-success"},{label:"Total Returns",value:this.formatCurrency(e.totalReturns),colorClass:e.totalReturns>0?"text-success":"text-danger"},{label:"XIRR",value:this.formatPercentage(e.xirr),colorClass:"text-info"}]}updateDipStatsArray(e){this.dipStats=[{label:"Dip Opportunities Captured",value:e.count.toString(),colorClass:"text-warning"},{label:"Total Dip Investments",value:this.formatCurrency(e.amount),colorClass:"text-info"},{label:"% of Total Investment",value:`${e.percentage.toFixed(1)}%`,colorClass:"text-success"}]}updateComparisonMetrics(e,i){const o={additionalWealth:e.currentValue-i.currentValue,xirrImprovement:100*(e.xirr-i.xirr),extraInvestment:e.totalInvested-i.totalInvested};this._comparisonMetrics$.next(o),this.comparisonMetricsArray=[{label:"Additional Wealth",value:this.formatCurrency(o.additionalWealth),colorClass:"text-success"},{label:"XIRR Improvement",value:`${o.xirrImprovement.toFixed(2)}%`,colorClass:"text-info"},{label:"Extra Investment",value:this.formatCurrency(o.extraInvestment),colorClass:"text-warning"}]}updateRecentTransactions(e){const i=e.transactions.slice(-50).reverse();this._recentTransactions$.next(i)}updateDipRulesArray(){this.dipRulesArray=this.dipRules.controls}onFormSubmit(){this.dipForm.valid&&this.calculateSIP()}addDipRule(){this.dipRules.push(this.createDipRule(15,15e3)),this.updateDipRulesArray()}removeDipRule(e){this.dipRules.length>1&&(this.dipRules.removeAt(e),this.updateDipRulesArray())}calculateSIP(){if(this.dipForm.invalid)return;this._isCalculating$.next(!0);const e=this.dipForm.value;setTimeout(()=>{try{const i=this.calculatorService.calculateDipInvestment({startDate:new Date(e.startDate),endDate:new Date(e.endDate),baseAmount:e.baseAmount,dipRules:e.dipRules,lookbackDays:e.lookbackDays}),o=this.calculatorService.calculateRegularSip({startDate:new Date(e.startDate),endDate:new Date(e.endDate),monthlyAmount:e.baseAmount,sipDate:1});this._sipResult$.next(i),this.regularSipComparison$.next(o),this.calculateDipStats(i)}catch(i){console.error("Error calculating dip investment:",i)}finally{this._isCalculating$.next(!1),this.cdr.markForCheck()}},100)}calculateDipStats(e){const i=e.transactions.filter(m=>m.type.includes("Dip")),o=i.length,l=i.reduce((m,$)=>m+$.amount,0);this.dipStatsSubject$.next({count:o,amount:l,percentage:l/e.totalInvested*100})}resetForm(){for(this.dipForm.reset({startDate:"2010-01-01",endDate:"2024-12-17",baseAmount:1e4,lookbackDays:30});this.dipRules.length>0;)this.dipRules.removeAt(0);this.dipRules.push(this.createDipRule(5,5e3)),this.dipRules.push(this.createDipRule(10,1e4)),this.dipRules.push(this.createDipRule(20,2e4)),this.updateDipRulesArray()}applyPreset(e){const o={conservative:[{percentage:5,amount:5e3},{percentage:10,amount:1e4}],moderate:[{percentage:5,amount:5e3},{percentage:10,amount:1e4},{percentage:15,amount:15e3}],aggressive:[{percentage:3,amount:3e3},{percentage:7,amount:7e3},{percentage:12,amount:12e3},{percentage:20,amount:25e3}],opportunistic:[{percentage:2,amount:2e3},{percentage:5,amount:5e3},{percentage:8,amount:8e3},{percentage:12,amount:15e3},{percentage:20,amount:3e4}]}[e];for(;this.dipRules.length>0;)this.dipRules.removeAt(0);o.forEach(l=>{const s=this.createDipRule(l.percentage,l.amount);this.dipRules.push(s)}),this.updateDipRulesArray()}get sipResult$(){return this._sipResult$.asObservable()}get isCalculating$(){return this._isCalculating$.asObservable()}get recentTransactions$(){return this._recentTransactions$.asObservable()}get comparisonMetrics$(){return this._comparisonMetrics$.asObservable()}formatCurrency(e){return this.calculatorService.formatCurrency(e)}formatNumber(e,i=0){return this.calculatorService.formatNumber(e,i)}formatPercentage(e){return this.calculatorService.formatPercentage(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(r.qu),t.Y36(x.r),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dip-investment"]],standalone:!0,features:[t.jDz],decls:72,vars:13,consts:[[1,"dip-investment-page"],[1,"calculator-header"],[1,"container"],[1,"row","align-items-center"],[1,"col-md-8"],[1,"mb-2"],[1,"bi","bi-graph-down","me-3"],[1,"mb-0"],[1,"col-md-4","text-md-end"],["routerLink","/calculator",1,"btn","btn-outline-light","me-2"],[1,"bi","bi-house","me-2"],[1,"btn","btn-outline-light",3,"click"],[1,"bi","bi-arrow-clockwise","me-2"],[1,"container","mt-4"],[1,"row"],[1,"col-lg-4"],[1,"card","card-custom"],[1,"card-body"],[1,"card-title","text-primary-custom","mb-4"],[1,"bi","bi-sliders","me-2"],[3,"formGroup","ngSubmit"],[1,"row","mb-3"],[1,"col-6"],[1,"form-label","fw-semibold"],["type","date","formControlName","startDate",1,"form-control"],["type","date","formControlName","endDate",1,"form-control"],[1,"mb-3"],[1,"input-group"],[1,"input-group-text"],["type","number","formControlName","baseAmount",1,"form-control"],[1,"form-text"],[1,"mb-4"],["type","number","formControlName","lookbackDays",1,"form-control"],["formArrayName","dipRules"],["class","dip-rule-item mb-3",3,"formGroupName",4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"btn","btn-outline-primary","btn-sm","w-100",3,"click"],[1,"bi","bi-plus","me-2"],[1,"quick-presets","mt-4"],[1,"fw-semibold","mb-3"],[1,"row","g-2"],["class","col-6",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-lg-8"],["class","text-center py-5",4,"ngIf"],[4,"ngIf"],[1,"dip-rule-item","mb-3",3,"formGroupName"],[1,"col-5"],[1,"form-label"],[1,"input-group","input-group-sm"],["type","number","formControlName","percentage","min","1","max","50",1,"form-control"],["type","number","formControlName","amount","min","1000",1,"form-control"],[1,"col-2","d-flex","align-items-end"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"disabled","click"],[1,"bi","bi-trash"],[1,"btn","btn-outline-primary","btn-sm","w-100",3,"click"],[1,"text-center","py-5"],[1,"loading-spinner","me-2"],[1,"row","g-3","mb-4"],["class","col-md-3",4,"ngFor","ngForOf","ngForTrackBy"],[1,"card","card-custom","mb-4"],[1,"card-title"],[1,"bi","bi-graph-down","me-2"],[1,"row","text-center"],["class","col-md-4",4,"ngFor","ngForOf","ngForTrackBy"],["class","card card-custom mb-4",4,"ngIf"],[1,"bi","bi-list-ul","me-2"],[1,"badge","bg-primary","ms-2"],[1,"table-responsive","custom-scrollbar",2,"max-height","400px"],[1,"table","table-hover","table-sm"],[1,"table-dark","sticky-top"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-md-3"],[1,"metric-card"],[1,"metric-value",3,"ngClass"],[1,"metric-label"],[1,"col-md-4"],[1,"bi","bi-bar-chart-steps","me-2"],[1,"comparison-metric"],[1,"badge"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),t._UZ(6,"i",6),t._uU(7," Dip Investment Calculator "),t.qZA(),t.TgZ(8,"p",7),t._uU(9,"Invest additional amounts when NIFTY BEES falls for enhanced returns"),t.qZA()(),t.TgZ(10,"div",8)(11,"button",9),t._UZ(12,"i",10),t._uU(13,"Home "),t.qZA(),t.TgZ(14,"button",11),t.NdJ("click",function(){return i.resetForm()}),t._UZ(15,"i",12),t._uU(16,"Reset "),t.qZA()()()()(),t.TgZ(17,"div",13)(18,"div",14)(19,"div",15)(20,"div",16)(21,"div",17)(22,"h5",18),t._UZ(23,"i",19),t._uU(24,"Investment Parameters "),t.qZA(),t.TgZ(25,"form",20),t.NdJ("ngSubmit",function(){return i.onFormSubmit()}),t.TgZ(26,"div",21)(27,"div",22)(28,"label",23),t._uU(29,"Start Date"),t.qZA(),t._UZ(30,"input",24),t.qZA(),t.TgZ(31,"div",22)(32,"label",23),t._uU(33,"End Date"),t.qZA(),t._UZ(34,"input",25),t.qZA()(),t.TgZ(35,"div",26)(36,"label",23),t._uU(37,"Base Monthly SIP"),t.qZA(),t.TgZ(38,"div",27)(39,"span",28),t._uU(40,"\u20b9"),t.qZA(),t._UZ(41,"input",29),t.qZA(),t.TgZ(42,"div",30),t._uU(43,"Regular monthly investment amount"),t.qZA()(),t.TgZ(44,"div",31)(45,"label",23),t._uU(46,"Lookback Period (Min 7)"),t.qZA(),t.TgZ(47,"div",27),t._UZ(48,"input",32),t.TgZ(49,"span",28),t._uU(50,"days"),t.qZA()(),t.TgZ(51,"div",30),t._uU(52,"Compare current price with highest price in last N days"),t.qZA()(),t.TgZ(53,"div",31)(54,"label",23),t._uU(55,"Dip Investment Rules"),t.qZA(),t.TgZ(56,"div",33),t.YNc(57,A,19,2,"div",34),t.qZA(),t.TgZ(58,"button",35),t.NdJ("click",function(){return i.addDipRule()}),t._UZ(59,"i",36),t._uU(60,"Add Dip Rule "),t.qZA()()(),t.TgZ(61,"div",37)(62,"h6",38),t._uU(63,"Quick Presets"),t.qZA(),t.TgZ(64,"div",39),t.YNc(65,C,6,2,"div",40),t.qZA()()()()(),t.TgZ(66,"div",41),t.YNc(67,D,3,0,"div",42),t.ALo(68,"async"),t.YNc(69,F,38,12,"ng-container",43),t.ALo(70,"async"),t.ALo(71,"async"),t.qZA()()()()),2&e&&(t.xp6(25),t.Q6J("formGroup",i.dipForm),t.xp6(32),t.Q6J("ngForOf",i.dipRulesArray)("ngForTrackBy",i.trackByIndex),t.xp6(8),t.Q6J("ngForOf",i.presetOptions)("ngForTrackBy",i.trackByPreset),t.xp6(2),t.Q6J("ngIf",t.lcZ(68,7,i.isCalculating$)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(70,9,i.isCalculating$)&&t.lcZ(71,11,i.sipResult$)))},dependencies:[u.ez,u.mk,u.sg,u.O5,u.Ov,u.uU,r.UX,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.qQ,r.Fd,r.sg,r.u,r.x0,r.CE,v.Bz,v.rH],styles:[".calculator-header[_ngcontent-%COMP%]{background:var(--primary-gradient);color:#fff;padding:2rem 0}.dip-rule-item[_ngcontent-%COMP%]{background:rgba(102,126,234,.1);padding:1rem;border-radius:10px}.comparison-metric[_ngcontent-%COMP%]{padding:1rem;border-radius:8px;background:rgba(16,185,129,.1);margin-bottom:1rem}.loading-spinner[_ngcontent-%COMP%]{width:1rem;height:1rem;border:2px solid #f3f3f3;border-top:2px solid #3498db;border-radius:50%;animation:spin 1s linear infinite;display:inline-block}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"],changeDetection:0}),n})()}}]);