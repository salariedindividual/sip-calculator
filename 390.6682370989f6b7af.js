"use strict";(self.webpackChunknifty_bees_calculator=self.webpackChunknifty_bees_calculator||[]).push([[390],{3390:(B,g,l)=>{l.r(g),l.d(g,{DipInvestmentComponent:()=>O});var u=l(6895),a=l(433),h=l(6214),p=l(1135),v=l(7579),b=l(4671),f=l(4482),Z=l(5403);function _(n,s){return n===s}var T=l(5243),d=l(2722),x=l(1548),t=l(8256),C=l(114);function A(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",44)(1,"div",39)(2,"div",45)(3,"label",46),t._uU(4,"Fall %"),t.qZA(),t.TgZ(5,"div",47),t._UZ(6,"input",48),t.TgZ(7,"span",28),t._uU(8,"%"),t.qZA()()(),t.TgZ(9,"div",45)(10,"label",46),t._uU(11,"Investment"),t.qZA(),t.TgZ(12,"div",47)(13,"span",28),t._uU(14,"\u20b9"),t.qZA(),t._UZ(15,"input",49),t.qZA()(),t.TgZ(16,"div",50)(17,"button",51),t.NdJ("click",function(){const o=t.CHM(e).index,r=t.oxw();return t.KtG(r.removeDipRule(o))}),t._UZ(18,"i",52),t.qZA()()()()}if(2&n){const e=s.index,i=t.oxw();t.Q6J("formGroupName",e),t.xp6(17),t.Q6J("disabled",i.dipRulesArray.length<=1)}}function D(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",22)(1,"button",53),t.NdJ("click",function(){const o=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.applyPreset(o.key))}),t._uU(2),t._UZ(3,"br"),t.TgZ(4,"small"),t._uU(5),t.qZA()()()}if(2&n){const e=s.$implicit;t.xp6(2),t.hij(" ",e.name,""),t.xp6(3),t.Oqu(e.description)}}function I(n,s){1&n&&(t.TgZ(0,"div",54),t._UZ(1,"div",55),t._uU(2," Calculating dip investment returns... "),t.qZA())}function k(n,s){if(1&n&&(t.TgZ(0,"div",71)(1,"div",72)(2,"div",73),t._uU(3),t.qZA(),t.TgZ(4,"div",74),t._uU(5),t.qZA()()()),2&n){const e=s.$implicit;t.xp6(2),t.Q6J("ngClass",e.colorClass),t.xp6(1),t.Oqu(e.value),t.xp6(2),t.Oqu(e.label)}}function U(n,s){if(1&n&&(t.TgZ(0,"div",75)(1,"div",73),t._uU(2),t.qZA(),t.TgZ(3,"div",74),t._uU(4),t.qZA()()),2&n){const e=s.$implicit;t.xp6(1),t.Q6J("ngClass",e.colorClass),t.xp6(1),t.Oqu(e.value),t.xp6(2),t.Oqu(e.label)}}function R(n,s){if(1&n&&(t.TgZ(0,"div",75)(1,"div",77)(2,"div",73),t._uU(3),t.qZA(),t.TgZ(4,"div",74),t._uU(5),t.qZA()()()),2&n){const e=s.$implicit;t.xp6(2),t.Q6J("ngClass",e.colorClass),t.xp6(1),t.Oqu(e.value),t.xp6(2),t.Oqu(e.label)}}function q(n,s){if(1&n&&(t.TgZ(0,"div",58)(1,"div",17)(2,"h6",59),t._UZ(3,"i",76),t._uU(4," Dip Strategy vs Regular SIP Comparison "),t.qZA(),t.TgZ(5,"div",61),t.YNc(6,R,6,3,"div",62),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(6),t.Q6J("ngForOf",e.comparisonMetricsArray)("ngForTrackBy",e.trackByComparison)}}function F(n,s){if(1&n&&t._UZ(0,"app-investment-growth-chart",78),2&n){const e=t.oxw(2);t.Q6J("dates",e.chartDates)("invested",e.chartInvested)("portfolio",e.chartPortfolio)}}function S(n,s){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"td")(5,"span",79),t._uU(6),t.qZA()(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA()()),2&n){const e=s.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(t.xi3(3,10,e.date,"dd/MM/yyyy")),t.xp6(3),t.ekj("bg-primary","Regular SIP"===e.type)("bg-success",e.type.includes("Dip")),t.xp6(1),t.hij(" ",e.type," "),t.xp6(2),t.hij("\u20b9",i.formatNumber(e.amount),""),t.xp6(2),t.hij("\u20b9",e.price.toFixed(2),""),t.xp6(2),t.Oqu(e.units.toFixed(2)),t.xp6(2),t.Oqu(e.totalUnits.toFixed(2))}}function $(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"div",56),t.YNc(2,k,6,3,"div",57),t.qZA(),t.TgZ(3,"div",58)(4,"div",17)(5,"h6",59),t._UZ(6,"i",60),t._uU(7," Dip Investment Statistics "),t.qZA(),t.TgZ(8,"div",61),t.YNc(9,U,5,3,"div",62),t.qZA()()(),t.YNc(10,q,7,2,"div",63),t.ALo(11,"async"),t.YNc(12,F,1,3,"app-investment-growth-chart",64),t.TgZ(13,"div",16)(14,"div",17)(15,"h6",59),t._UZ(16,"i",65),t._uU(17," Recent Transactions "),t.TgZ(18,"span",66),t._uU(19),t.qZA()(),t.TgZ(20,"div",67)(21,"table",68)(22,"thead",69)(23,"tr")(24,"th"),t._uU(25,"Date"),t.qZA(),t.TgZ(26,"th"),t._uU(27,"Type"),t.qZA(),t.TgZ(28,"th"),t._uU(29,"Amount"),t.qZA(),t.TgZ(30,"th"),t._uU(31,"Price"),t.qZA(),t.TgZ(32,"th"),t._uU(33,"Units"),t.qZA(),t.TgZ(34,"th"),t._uU(35,"Total Units"),t.qZA()()(),t.TgZ(36,"tbody"),t.YNc(37,S,15,13,"tr",70),t.ALo(38,"async"),t.qZA()()()()(),t.BQk()),2&n){const e=s.ngIf,i=t.oxw();t.xp6(2),t.Q6J("ngForOf",i.keyMetrics)("ngForTrackBy",i.trackByMetric),t.xp6(7),t.Q6J("ngForOf",i.dipStats)("ngForTrackBy",i.trackByStat),t.xp6(1),t.Q6J("ngIf",t.lcZ(11,9,i.comparisonMetrics$)),t.xp6(2),t.Q6J("ngIf",i.chartDates.length>0),t.xp6(7),t.hij("",e.transactions.length," total"),t.xp6(18),t.Q6J("ngForOf",t.lcZ(38,11,i.recentTransactions$))("ngForTrackBy",i.trackByTransaction)}}let O=(()=>{class n{constructor(e,i,c){this.fb=e,this.calculatorService=i,this.cdr=c,this._sipResult$=new p.X(null),this.regularSipComparison$=new p.X(null),this._isCalculating$=new p.X(!1),this.dipStatsSubject$=new p.X({count:0,amount:0,percentage:0}),this._recentTransactions$=new p.X([]),this._comparisonMetrics$=new p.X(null),this.destroy$=new v.x,this.dipRulesArray=[],this.keyMetrics=[],this.dipStats=[],this.comparisonMetricsArray=[],this.chartDates=[],this.chartInvested=[],this.chartPortfolio=[],this.presetOptions=[{key:"conservative",name:"Conservative",description:"5%, 10% dips"},{key:"moderate",name:"Moderate",description:"5%, 10%, 15%"},{key:"aggressive",name:"Aggressive",description:"Multiple levels"},{key:"opportunistic",name:"Opportunistic",description:"Small dips too"}],this.trackByIndex=o=>o,this.trackByPreset=(o,r)=>r.key,this.trackByMetric=(o,r)=>r.label,this.trackByStat=(o,r)=>r.label,this.trackByComparison=(o,r)=>r.label,this.trackByTransaction=(o,r)=>`${r.date.getTime()}-${r.type}`}ngOnInit(){this.initializeForm(),this.setupFormValidation(),this.subscribeToStateChanges(),this.calculateSIP()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}get dipRules(){return this.dipForm.get("dipRules")}initializeForm(){this.dipForm=this.fb.group({startDate:["2010-01-01",a.kI.required],endDate:["2024-12-17",a.kI.required],baseAmount:[1e4,[a.kI.required,a.kI.min(500)]],lookbackDays:[30,[a.kI.required,a.kI.min(7),a.kI.max(365)]],dipRules:this.fb.array([this.createDipRule(5,5e3),this.createDipRule(10,1e4),this.createDipRule(20,2e4)])}),this.updateDipRulesArray()}createDipRule(e,i){return this.fb.group({percentage:[e,[a.kI.required,a.kI.min(1),a.kI.max(50)]],amount:[i,[a.kI.required,a.kI.min(1e3)]]})}setupFormValidation(){this.dipForm.valueChanges.pipe((0,T.b)(800),function y(n,s=b.y){return n=n??_,(0,f.e)((e,i)=>{let c,o=!0;e.subscribe((0,Z.x)(i,r=>{const m=s(r);(o||!n(c,m))&&(o=!1,c=m,i.next(r))}))})}((e,i)=>JSON.stringify(e)===JSON.stringify(i)),(0,d.R)(this.destroy$)).subscribe(()=>{this.dipForm.valid&&this.calculateSIP()})}subscribeToStateChanges(){this.sipResult$.pipe((0,d.R)(this.destroy$)).subscribe(e=>{e&&(this.updateKeyMetrics(e),this.updateRecentTransactions(e))}),this.regularSipComparison$.pipe((0,d.R)(this.destroy$)).subscribe(e=>{e&&this._sipResult$.value&&this.updateComparisonMetrics(this._sipResult$.value,e)}),this.dipStatsSubject$.pipe((0,d.R)(this.destroy$)).subscribe(e=>{this.updateDipStatsArray(e)})}updateKeyMetrics(e){this.keyMetrics=[{label:"Total Invested",value:this.formatCurrency(e.totalInvested),colorClass:"text-primary"},{label:"Current Value",value:this.formatCurrency(e.currentValue),colorClass:"text-success"},{label:"Total Returns",value:this.formatCurrency(e.totalReturns),colorClass:e.totalReturns>0?"text-success":"text-danger"},{label:"XIRR",value:this.formatPercentage(e.xirr),colorClass:"text-info"}]}updateDipStatsArray(e){this.dipStats=[{label:"Dip Opportunities Captured",value:e.count.toString(),colorClass:"text-warning"},{label:"Total Dip Investments",value:this.formatCurrency(e.amount),colorClass:"text-info"},{label:"% of Total Investment",value:`${e.percentage.toFixed(1)}%`,colorClass:"text-success"}]}updateComparisonMetrics(e,i){const c={additionalWealth:e.currentValue-i.currentValue,xirrImprovement:100*(e.xirr-i.xirr),extraInvestment:e.totalInvested-i.totalInvested};this._comparisonMetrics$.next(c),this.comparisonMetricsArray=[{label:"Additional Wealth",value:this.formatCurrency(c.additionalWealth),colorClass:"text-success"},{label:"XIRR Improvement",value:`${c.xirrImprovement.toFixed(2)}%`,colorClass:"text-info"},{label:"Extra Investment",value:this.formatCurrency(c.extraInvestment),colorClass:"text-warning"}]}updateRecentTransactions(e){const i=e.transactions.slice(-50).reverse();this._recentTransactions$.next(i)}updateDipRulesArray(){this.dipRulesArray=this.dipRules.controls}onFormSubmit(){this.dipForm.valid&&this.calculateSIP()}addDipRule(){this.dipRules.push(this.createDipRule(15,15e3)),this.updateDipRulesArray()}removeDipRule(e){this.dipRules.length>1&&(this.dipRules.removeAt(e),this.updateDipRulesArray())}calculateSIP(){if(this.dipForm.invalid)return;this._isCalculating$.next(!0);const e=this.dipForm.value;setTimeout(()=>{try{const i=this.calculatorService.calculateDipInvestment({startDate:new Date(e.startDate),endDate:new Date(e.endDate),baseAmount:e.baseAmount,dipRules:e.dipRules,lookbackDays:e.lookbackDays}),c=this.calculatorService.calculateRegularSip({startDate:new Date(e.startDate),endDate:new Date(e.endDate),monthlyAmount:e.baseAmount,sipDate:1});this._sipResult$.next(i),this.regularSipComparison$.next(c),this.calculateDipStats(i),this.chartDates=i.transactions.map(r=>r.date.toISOString().split("T")[0]);let o=0;this.chartInvested=[],this.chartPortfolio=[];for(const r of i.transactions)o+=r.amount,this.chartInvested.push(o),this.chartPortfolio.push(r.value)}catch(i){console.error("Error calculating dip investment:",i)}finally{this._isCalculating$.next(!1),this.cdr.markForCheck()}},100)}calculateDipStats(e){const i=e.transactions.filter(m=>m.type.includes("Dip")),c=i.length,o=i.reduce((m,w)=>m+w.amount,0);this.dipStatsSubject$.next({count:c,amount:o,percentage:o/e.totalInvested*100})}resetForm(){for(this.dipForm.reset({startDate:"2010-01-01",endDate:"2024-12-17",baseAmount:1e4,lookbackDays:30});this.dipRules.length>0;)this.dipRules.removeAt(0);this.dipRules.push(this.createDipRule(5,5e3)),this.dipRules.push(this.createDipRule(10,1e4)),this.dipRules.push(this.createDipRule(20,2e4)),this.updateDipRulesArray()}applyPreset(e){const c={conservative:[{percentage:5,amount:5e3},{percentage:10,amount:1e4}],moderate:[{percentage:5,amount:5e3},{percentage:10,amount:1e4},{percentage:15,amount:15e3}],aggressive:[{percentage:3,amount:3e3},{percentage:7,amount:7e3},{percentage:12,amount:12e3},{percentage:20,amount:25e3}],opportunistic:[{percentage:2,amount:2e3},{percentage:5,amount:5e3},{percentage:8,amount:8e3},{percentage:12,amount:15e3},{percentage:20,amount:3e4}]}[e];for(;this.dipRules.length>0;)this.dipRules.removeAt(0);c.forEach(o=>{const r=this.createDipRule(o.percentage,o.amount);this.dipRules.push(r)}),this.updateDipRulesArray()}get sipResult$(){return this._sipResult$.asObservable()}get isCalculating$(){return this._isCalculating$.asObservable()}get recentTransactions$(){return this._recentTransactions$.asObservable()}get comparisonMetrics$(){return this._comparisonMetrics$.asObservable()}formatCurrency(e){return this.calculatorService.formatCurrency(e)}formatNumber(e,i=0){return this.calculatorService.formatNumber(e,i)}formatPercentage(e){return this.calculatorService.formatPercentage(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(a.qu),t.Y36(C.r),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dip-investment"]],standalone:!0,features:[t.jDz],decls:72,vars:13,consts:[[1,"dip-investment-page"],[1,"calculator-header"],[1,"container"],[1,"row","align-items-center"],[1,"col-md-8"],[1,"mb-2"],[1,"bi","bi-graph-down","me-3"],[1,"mb-0"],[1,"col-md-4","text-md-end"],["routerLink","/calculator",1,"btn","btn-outline-light","me-2"],[1,"bi","bi-house","me-2"],[1,"btn","btn-outline-light",3,"click"],[1,"bi","bi-arrow-clockwise","me-2"],[1,"container","mt-4"],[1,"row"],[1,"col-lg-4"],[1,"card","card-custom"],[1,"card-body"],[1,"card-title","text-primary-custom","mb-4"],[1,"bi","bi-sliders","me-2"],[3,"formGroup","ngSubmit"],[1,"row","mb-3"],[1,"col-6"],[1,"form-label","fw-semibold"],["type","date","formControlName","startDate",1,"form-control"],["type","date","formControlName","endDate",1,"form-control"],[1,"mb-3"],[1,"input-group"],[1,"input-group-text"],["type","number","formControlName","baseAmount",1,"form-control"],[1,"form-text"],[1,"mb-4"],["type","number","formControlName","lookbackDays",1,"form-control"],["formArrayName","dipRules"],["class","dip-rule-item mb-3",3,"formGroupName",4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"btn","btn-outline-primary","btn-sm","w-100",3,"click"],[1,"bi","bi-plus","me-2"],[1,"quick-presets","mt-4"],[1,"fw-semibold","mb-3"],[1,"row","g-2"],["class","col-6",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-lg-8"],["class","text-center py-5",4,"ngIf"],[4,"ngIf"],[1,"dip-rule-item","mb-3",3,"formGroupName"],[1,"col-5"],[1,"form-label"],[1,"input-group","input-group-sm"],["type","number","formControlName","percentage","min","1","max","50",1,"form-control"],["type","number","formControlName","amount","min","1000",1,"form-control"],[1,"col-2","d-flex","align-items-end"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"disabled","click"],[1,"bi","bi-trash"],[1,"btn","btn-outline-primary","btn-sm","w-100",3,"click"],[1,"text-center","py-5"],[1,"loading-spinner","me-2"],[1,"row","g-3","mb-4"],["class","col-md-3",4,"ngFor","ngForOf","ngForTrackBy"],[1,"card","card-custom","mb-4"],[1,"card-title"],[1,"bi","bi-graph-down","me-2"],[1,"row","text-center"],["class","col-md-4",4,"ngFor","ngForOf","ngForTrackBy"],["class","card card-custom mb-4",4,"ngIf"],[3,"dates","invested","portfolio",4,"ngIf"],[1,"bi","bi-list-ul","me-2"],[1,"badge","bg-primary","ms-2"],[1,"table-responsive","custom-scrollbar",2,"max-height","400px"],[1,"table","table-hover","table-sm"],[1,"table-dark","sticky-top"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-md-3"],[1,"metric-card"],[1,"metric-value",3,"ngClass"],[1,"metric-label"],[1,"col-md-4"],[1,"bi","bi-bar-chart-steps","me-2"],[1,"comparison-metric"],[3,"dates","invested","portfolio"],[1,"badge"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),t._UZ(6,"i",6),t._uU(7," Dip Investment Calculator "),t.qZA(),t.TgZ(8,"p",7),t._uU(9,"Invest additional amounts when NIFTY BEES falls for enhanced returns"),t.qZA()(),t.TgZ(10,"div",8)(11,"button",9),t._UZ(12,"i",10),t._uU(13,"Home "),t.qZA(),t.TgZ(14,"button",11),t.NdJ("click",function(){return i.resetForm()}),t._UZ(15,"i",12),t._uU(16,"Reset "),t.qZA()()()()(),t.TgZ(17,"div",13)(18,"div",14)(19,"div",15)(20,"div",16)(21,"div",17)(22,"h5",18),t._UZ(23,"i",19),t._uU(24,"Investment Parameters "),t.qZA(),t.TgZ(25,"form",20),t.NdJ("ngSubmit",function(){return i.onFormSubmit()}),t.TgZ(26,"div",21)(27,"div",22)(28,"label",23),t._uU(29,"Start Date"),t.qZA(),t._UZ(30,"input",24),t.qZA(),t.TgZ(31,"div",22)(32,"label",23),t._uU(33,"End Date"),t.qZA(),t._UZ(34,"input",25),t.qZA()(),t.TgZ(35,"div",26)(36,"label",23),t._uU(37,"Base Monthly SIP"),t.qZA(),t.TgZ(38,"div",27)(39,"span",28),t._uU(40,"\u20b9"),t.qZA(),t._UZ(41,"input",29),t.qZA(),t.TgZ(42,"div",30),t._uU(43,"Regular monthly investment amount"),t.qZA()(),t.TgZ(44,"div",31)(45,"label",23),t._uU(46,"Lookback Period (Min 7)"),t.qZA(),t.TgZ(47,"div",27),t._UZ(48,"input",32),t.TgZ(49,"span",28),t._uU(50,"days"),t.qZA()(),t.TgZ(51,"div",30),t._uU(52,"Compare current price with highest price in last N days"),t.qZA()(),t.TgZ(53,"div",31)(54,"label",23),t._uU(55,"Dip Investment Rules"),t.qZA(),t.TgZ(56,"div",33),t.YNc(57,A,19,2,"div",34),t.qZA(),t.TgZ(58,"button",35),t.NdJ("click",function(){return i.addDipRule()}),t._UZ(59,"i",36),t._uU(60,"Add Dip Rule "),t.qZA()()(),t.TgZ(61,"div",37)(62,"h6",38),t._uU(63,"Quick Presets"),t.qZA(),t.TgZ(64,"div",39),t.YNc(65,D,6,2,"div",40),t.qZA()()()()(),t.TgZ(66,"div",41),t.YNc(67,I,3,0,"div",42),t.ALo(68,"async"),t.YNc(69,$,39,13,"ng-container",43),t.ALo(70,"async"),t.ALo(71,"async"),t.qZA()()()()),2&e&&(t.xp6(25),t.Q6J("formGroup",i.dipForm),t.xp6(32),t.Q6J("ngForOf",i.dipRulesArray)("ngForTrackBy",i.trackByIndex),t.xp6(8),t.Q6J("ngForOf",i.presetOptions)("ngForTrackBy",i.trackByPreset),t.xp6(2),t.Q6J("ngIf",t.lcZ(68,7,i.isCalculating$)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(70,9,i.isCalculating$)&&t.lcZ(71,11,i.sipResult$)))},dependencies:[u.ez,u.mk,u.sg,u.O5,u.Ov,u.uU,a.UX,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.qQ,a.Fd,a.sg,a.u,a.x0,a.CE,h.Bz,h.rH,x.U],styles:[".calculator-header[_ngcontent-%COMP%]{background:var(--primary-gradient);color:#fff;padding:2rem 0}.dip-rule-item[_ngcontent-%COMP%]{background:rgba(102,126,234,.1);padding:1rem;border-radius:10px}.comparison-metric[_ngcontent-%COMP%]{padding:1rem;border-radius:8px;background:rgba(16,185,129,.1);margin-bottom:1rem}.loading-spinner[_ngcontent-%COMP%]{width:1rem;height:1rem;border:2px solid #f3f3f3;border-top:2px solid #3498db;border-radius:50%;animation:spin 1s linear infinite;display:inline-block}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"],changeDetection:0}),n})()}}]);